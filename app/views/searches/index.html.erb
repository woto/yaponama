<h1>Поиск запчастей</h1>

<%= form_tag searches_path, :method => :get do |f| %>
  <div class="inputs">

    <div class="clearfix string optional">
      <label class="string optional">
        Каталожный номер
      </label>
      <div class="input">
        <%= text_field_tag :catalog_number, params[:catalog_number] %> <br />
      </div>
    </div>
    

    <div class="clearfix string optional">
      <label class="string optional">
        Производитель
      </label>
      <div class="input">
        <%= text_field_tag :manufacturer, params[:manufacturer] %> <br />
      </div>
    </div>


    <div class="clearfix string optional">
      <label class="string optional">
        Замены и аналоги
      </label>
      <div class="input" style="margin-top: 6px">
        <%= check_box_tag :replacements, "1", params[:replacements] %> <br />
      </div>
    </div>

    <div class="actions">
      <%= submit_tag "Искать", :class => "primary btn" %>
    </div>
  </div>
<% end %>

</style>
<% if @parsed_json["result_prices"].count > 0 %>
  <table id="result-prices" class="zebra-striped">
    <thead>
      <tr>
        <th class="yellow {sorter: 'text'}"> Произв. </th>
        <th class="magenta {sorter: 'text'}">Кат.&nbsp;ном. </th>
        <th class="blue {sorter: 'text'}"> Название </th>
        <th class="green"> Шт. </th>
        <th class="cyan"> Заявл. </th>
        <th class="cyan"> Гар.  </th>
        <th class="red"> Цена </th>
      </tr>
    </thead>
    <tbody>
      <% @parsed_json["result_prices"].each do |result_price| %>
        <tr>
          <td> <%= result_price["manufacturer"] %> </td>
          <td> <%= result_price["catalog_number"] %> </td>
          <td> <%= result_price["title"] %><br /><%= result_price["title_en"] %> </td>
          <td> <%= ((count = result_price["count"].to_s.gsub(/\D/, '').to_i) > 1) ? count : '*' %> </td>
          <td> <%= result_price["job_import_job_delivery_days_declared"] %> </td>
          <td> <%= result_price["job_import_job_delivery_days_average"] %> </td>
          <td> <a class="btn primary" style="width: 40px" href="#"><%= (result_price["income_cost"] * 1.07).to_i %></a></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>

<div style="clear: both">
  <div id="pager" class="pager" style="position: relative">
    <form>
      <div class="first"/>Первая</div>
      <div class="prev">Предыдущая</div>
      <input type="text" class="pagedisplay"/>
      <div class="next"/>Вперед</div>
      <div class="last">Последняя</div>
      <select class="pagesize">
        <option selected="selected"  value="10">10</option>
        <option value="20">20</option>
        <option value="30">30</option>
        <option  value="40">40</option>
      </select>
    </form>
  </div>
</div>                                                            
<br />
<br />
<br />
<br />
<br />
<br />
<p><span class="label">К сведению</span> Бывает так, что разные производители выпускают детали под одним и тем же каталожным номером. Эти детали могут являться заменами друг другу, как впрочем и нет. Например можете поискать каталожный номер <a href="searches?utf8=✓&catalog_number=1517&manufacturer=&replacements=1&commit=Искать">1517 без производителя</a> или <a href="searches?utf8=✓&catalog_number=1517&manufacturer=JOBBER&replacements=1&commit=Искать">1517 - JOBBER</a> и <a href="searches?utf8=✓&catalog_number=1517&manufacturer=FEBI&replacements=1&commit=Искать">1517 - FEBI </a>. Поэтому для отображения более точных результатов замен щелкните на ссылке в полученном списке для указания искомого производителя и замен только по этому типу деталей.</p>
